const Sakana=(t=>{const{log:e}=console,a={chisato:{r:1,y:40,t:0,w:0,d:.99},takina:{r:12,y:2,t:0,w:0,d:.988}},n={chisato:new Audio("chinanago.mp3"),takina:new Audio("sakana.mp3"),isMute:!0},o=[{text:"王二狗",audio:new Audio("sakana.mp3")},{text:"虚研村",audio:new Audio("xuyancun.mp3")},{text:"虚研社长",audio:new Audio("xuyanshezhang.mp3")},{text:"中国台湾",audio:new Audio("zhongguotaiwan.mp3")},{text:"中国东北",audio:new Audio("zhongguodongbei.mp3")},{text:"中国北京",audio:new Audio("zhongguobeijing.mp3")}];let s=0;n.takina.volume=n.chisato.volume=.8,n.takina.muted=n.chisato.muted=n.isMute;const i="function"==typeof window.structuredClone?t=>window.structuredClone(t):t=>JSON.parse(JSON.stringify(t));return e("绘: %c_真名_ %c已取得在网页中使用的非商用授权","font-weight:bold","color:#C34","https://weibo.com/n/_%E7%9C%9F%E5%90%8D_"),{init:(t={})=>{const{decay:o,onSwitchCharacter:s=(t=>{}),scale:r="auto",translateY:c=0,strokeStyle:u="#EEEEEE",canSwitchCharacter:d=!1}=t;let{el:m,character:l="takina",inertia:h,originRotate:g=0,r:y,y:p}=t;if(m.constructor===String&&(m=document.querySelector(m)),!m)throw new Error("invalid Element");h||(h=.08),h=Math.min(.5,Math.max(0,h));let w;const v=m;v.classList.add("sakana-box"),v.innerHTML='<canvas></canvas><div class="sakana-character"></div><div class="sakana-bed"></div>';const k=v.querySelector(".sakana-character"),E=v.querySelector(".sakana-bed"),x=v.querySelector("canvas");v.style.transform=`translateY(${c||0}) scale(${r})`;let M=!1;const b=1*(window.devicePixelRatio||1),f=500*b,S=800*b;x.width=f,x.height=S,x.style.width="500px",x.style.height="800px";const A=x.getContext("2d");A.setTransform(1,0,0,1,0,0),A.scale(b,b);const C=t=>{let{r:e,y:a,t:n,w:o,d:s}=w;const i=1*e;k.style.transform=`rotate(${e}deg) translateX(${i}px) translateY(${a}px)`,A.clearRect(0,0,500,800),A.save(),A.strokeStyle=u,A.lineWidth=10,A.beginPath(),A.translate(250,640),A.moveTo(0,140);const r=((t,e,a,n,o)=>{const s=Math.PI/180*o,i=Math.cos(s),r=Math.sin(s);return{x:i*(a-t)+r*(n-e)+t,y:i*(n-e)-r*(a-t)+e}})(0,-100,i,-a,e),c=r.x,d=-r.y-100;A.quadraticCurveTo(0,75,c,d),A.stroke(),A.restore()};let L=+new Date;const q=t=>{if(!M)return;const e=+new Date;let a=h;const n=e-L;n<16&&(a=h/(1e3/60)*n),L=e;let{r:o,y:s,t:i,w:r,d:c}=w;if(o+=(r=r-2*o-g)*a*1.2,w.w=r*c,w.r=o,s+=(i-=2*s)*a*2,w.t=i*c,w.y=s,Math.max(Math.abs(w.w),Math.abs(w.r),Math.abs(w.t),Math.abs(w.y))<.1)return M=!1;requestAnimationFrame(q),C()},F=(t,e)=>{let a=.1*t;a=Math.max(-60,a),a=Math.min(60,a),e=.1*e*2,e=Math.max(-110,e),e=Math.min(110,e),w.r=a,w.y=e,w.w=0,w.t=0,C()};k.addEventListener("mousedown",t=>{t.preventDefault(),M=!1;const{pageX:e,pageY:a}=t,o=a;n.takina.muted=n.chisato.muted=n.isMute,w.w=0,w.t=0;const s=t=>{const e=v.getBoundingClientRect(),a=e.left+e.width/2,{pageX:n,pageY:s}=t;e.top,F(n-a,s-o)},i=t=>{t.preventDefault(),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",i),M=!0,D(),requestAnimationFrame(q)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",i)});k.addEventListener("touchstart",t=>{if(t.preventDefault(),M=!1,!t.touches[0])return;const{pageX:e,pageY:a}=t.touches[0],o=a;n.takina.muted=n.chisato.muted=n.isMute,w.w=0,w.t=0;const s=t=>{if(!t.touches[0])return;const e=v.getBoundingClientRect(),a=e.left+e.width/2,{pageX:n,pageY:s}=t.touches[0];e.top,F(n-a,s-o)},i=t=>{document.removeEventListener("touchmove",s),document.removeEventListener("touchend",i),M=!0,D(),requestAnimationFrame(q)};document.addEventListener("touchmove",s),document.addEventListener("touchend",i)});const R=t=>{M||(M=!0,requestAnimationFrame(q))},T=t=>{k.setAttribute("data-character",t);const e=a[t];e&&(w=i(e),o&&(w.d=o),y&&(w.r=y),y&&(w.y=p),R())},B=t=>{"chisato"===l?(l="takina",document.getElementsByTagName("html")[0].style.background="#F77F96",document.getElementById("barkSource").style.display="block"):(l="chisato",document.getElementsByTagName("html")[0].style.background="#F2CEFC",document.getElementById("barkSource").style.display="none"),T(l),s(l)};d&&(v.setAttribute("data-can-switch-character",d),E.addEventListener("click",t=>{t.preventDefault(),B()}));const D=t=>{n.isMute||(e({r:w.r,y:w.y}),"chisato"===l?n.chisato.play():n.takina.play())};return T(l),{setCharacter:T,switchCharacter:B,setOriginRotate:t=>g=t,confirmRunning:R,pause(){M=!1},play(){R()},getValue:()=>w,getRunning:()=>M}},Voices:n,setMute(t){n.isMute=t,n.takina.muted=n.chisato.muted=t},destroy(){running=!1,el.innerHTML=""},changeVoice:()=>{s+1<o.length?s+=1:s=0,n.takina=o[s].audio,document.getElementById("barkSource").innerText=`狗叫来源：${o[s].text}`}}})();"object"==typeof module&&module.exports&&(module.exports=Sakana);